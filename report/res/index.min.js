define(["exports","@hpcc-js/chart","@hpcc-js/comms","@hpcc-js/layout","@hpcc-js/other","@hpcc-js/html"],function(t,n,e,r,o,i){"use strict";var a,l=(a=function(t,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),u=function(t){return["attribute","given_attribute_type","best_attribute_type","rec_count","fill_count","fill_rate","cardinality","cardinality_breakdown","modes","min_length","max_length","ave_length","popular_patterns","rare_patterns","is_numeric","numeric_min","numeric_max","numeric_mean","numeric_std_dev","numeric_lower_quartile","numeric_median","numeric_upper_quartile","numeric_correlations"].indexOf(t.ColumnName)>0},c=function(t,n){return void 0===n&&(n=4),function(t){return t.ECLSchemas.ECLSchemaItem.filter(u).length}(t)>=n},s={rowHeight:180,primaryFontSize:20,secondaryFontSize:14,primaryColor:"#494949",secondaryColor:"#DDD",offwhiteColor:"#FBFBFB",blueColor:"#1A99D5"},d=function(t){function a(n){var r=t.call(this)||this;r._espUrl=n,r.gutter(0).surfaceShadow(!1).surfacePadding("0").surfaceBorderWidth(0);var o=r._espUrl.split("/WsWorkunits/res/"),i=o[0],a=o[1].split("/report/res/index.html")[0];return r._wu=e.Workunit.attach({baseUrl:i},a),r}return l(a,t),a.prototype.enter=function(e,a){var l=this;t.prototype.enter.call(this,e,a),e.style.height=this._data.length*s.rowHeight+"px",this._data.forEach(function(t,e){var a=(new r.Grid).surfaceShadow(!1).surfaceBorderWidth(0),u=p(t),c=function(t){if(t.cardinality_breakdown.Row.length>0){var e=0;e=t.cardinality_breakdown.Row.length;var r=t.cardinality_breakdown.Row.map(function(t){return[t.value.trim(),t.rec_count]});return o("Cardinality Breakdown",e>4?i.BreakdownTable:i.StyledTable,r)}if(t.is_numeric)return(new n.QuartileCandlestick).columns(["Min","25%","50%","75%","Max"]).data([t.numeric_min,t.numeric_lower_quartile,t.numeric_median,t.numeric_upper_quartile,t.numeric_max]).edgePadding(30).dataHeight(20).roundedCorners(1).lineWidth(1);if(t.popular_patterns.Row.length>0){var r=t.popular_patterns.Row.map(function(t){return[t.data_pattern.trim(),t.rec_count]});return o("Popular Patterns",i.BreakdownTable,r)}function o(t,n,e){return(new n).columns([t,""]).theadColumnStyles([{"text-align":"left","font-size":s.secondaryFontSize+"px"}]).data(e)}}(t),d=function(t){if(t.is_numeric)return(new i.StyledTable).data([["Mean",t.numeric_mean,""],["Std. Deviation",t.numeric_std_dev,""],["","",""],["Quantiles",t.numeric_min,"Min"],["",t.numeric_lower_quartile,"25%"],["",t.numeric_median,"50%"],["",t.numeric_upper_quartile,"75%"],["",t.numeric_max,"Max"]]).tbodyColumnStyles([{"font-weight":"bold"},{"font-weight":"normal"},{"font-weight":"normal"}]);if(t.popular_patterns.Row.length>0)return(new i.StyledTable).data([["Min Length",t.min_length,""],["Avg Length",t.ave_length,""],["Max Length",t.max_length,""]]).tbodyColumnStyles([{"font-weight":"bold"},{"font-weight":"normal"},{"font-weight":"normal"}]);return p(t)}(t);function p(t){var n=(new o.Html).html('<span style="\n                        padding-top:6px;\n                        display:inline-block;\n                        font-size:'+s.primaryFontSize+'px;\n                    ">'+t.attribute+'</span><br/>\n                    <span style="\n                        color:'+s.primaryColor+";\n                        padding:8px;\n                        display:inline-block;\n                        font-size:"+s.secondaryFontSize+"px;\n                        margin-top:4px;\n                        border:1px solid "+s.secondaryColor+";\n                        border-radius:4px;\n                        background-color: "+s.offwhiteColor+';\n                    ">\n                        <i style="\n                            font-size:'+s.secondaryFontSize+"px;\n                            color:"+s.blueColor+';\n                        " class="fa '+("string"===t.best_attribute_type.slice(0,6)?"fa-font":"fa-hashtag")+'"></i>\n                        '+t.given_attribute_type+' (given)\n                    </span>\n                    <span style="\n                        color:'+s.primaryColor+";\n                        padding:8px;\n                        display:inline-block;\n                        font-size:"+s.secondaryFontSize+"px;\n                        margin-top:4px;\n                        border:1px solid "+s.secondaryColor+";\n                        border-radius:4px;\n                        background-color: "+s.offwhiteColor+';\n                    ">\n                        <i style="\n                            font-size:'+s.secondaryFontSize+"px;\n                            color:"+s.blueColor+';\n                        " class="fa '+("string"===t.best_attribute_type.slice(0,6)?"fa-font":"fa-hashtag")+'"></i>\n                        '+t.best_attribute_type+" (best)\n                    </span>\n                    ").overflowX("hidden").overflowY("hidden"),e=100===t.fill_rate||0===t.fill_rate?t.fill_rate:t.fill_rate.toFixed(1),a=(new i.StyledTable).data([["Cardinality",t.cardinality,"~"+(t.cardinality/t.fill_count*100).toFixed(0)+"%"],["Filled",t.fill_count,e+"%"]]).tbodyColumnStyles([{"font-weight":"bold","font-size":s.secondaryFontSize+"px"},{"font-weight":"normal","font-size":s.secondaryFontSize+"px"},{"font-weight":"normal","font-size":s.secondaryFontSize+"px"}]);return(new r.Grid).gutter(0).surfaceShadow(!1).surfacePadding("0").surfaceBorderWidth(0).setContent(0,0,n,"",1,1).setContent(1,0,a,"",1,1)}a.setContent(0,0,u,void 0,1,1).setContent(0,1,d,void 0,1,1).setContent(0,2,c,void 0,1,1),l.setContent(e,0,a)})},a.prototype.update=function(n,e){t.prototype.update.call(this,n,e)},a.prototype.render=function(n){var e=this;return this._wu.fetchResults().then(function(t){for(var n=0,e=t;n<e.length;n++){var r=e[n];if(c(r))return r}}).then(function(t){return t?t.fetchRows():[]}).then(function(r){e._data=r,t.prototype.render.call(e,function(t){n&&n(e)})}),this},a}(r.Grid);t.Test=d,Object.defineProperty(t,"__esModule",{value:!0})});